if (withmetis)
    {
      metisdual(lpart,Th,npart); 
      for(int i=0;i<lpart.n;++i)
          part[][i]=lpart[i];
    }
  else
    {
    Ph xx=x,yy=y, zz=z;
    part= int(xx/allongx*nn)*mm*ll + int(zz/allongz*ll)*mm+int(y*mm); 
    }